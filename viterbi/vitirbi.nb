(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[         0,          0]
NotebookDataLength[     57894,       1180]
NotebookOptionsPosition[     56362,       1125]
NotebookOutlinePosition[     56718,       1141]
CellTagsIndexPosition[     56675,       1138]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"d", " ", "=", " ", 
   RowBox[{"Import", "[", 
    RowBox[{"\"\<~/Downloads/cpg.hmm\>\"", ",", " ", "\"\<Table\>\""}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"trans", " ", "=", " ", 
   RowBox[{"d", "\[LeftDoubleBracket]", 
    RowBox[{"All", ",", " ", 
     RowBox[{"Range", "[", 
      RowBox[{"3", ",", " ", "12"}], "]"}]}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"emit", " ", "=", " ", 
   RowBox[{
    RowBox[{"Import", "[", 
     RowBox[{"\"\<~/Downloads/emissions.hmm\>\"", ",", " ", "\"\<Table\>\""}],
      "]"}], "\[LeftDoubleBracket]", 
    RowBox[{"All", ",", " ", 
     RowBox[{"Range", "[", 
      RowBox[{"2", ",", "5"}], "]"}]}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"letters", " ", "=", " ", 
   RowBox[{"d", "\[LeftDoubleBracket]", 
    RowBox[{"All", ",", " ", "1"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"symbols", " ", "=", " ", 
   RowBox[{"d", "\[LeftDoubleBracket]", 
    RowBox[{"All", ",", " ", "2"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"states", " ", "=", " ", 
   RowBox[{"MapThread", "[", 
    RowBox[{"StringJoin", ",", " ", 
     RowBox[{"Map", "[", 
      RowBox[{"ToString", ",", " ", 
       RowBox[{"List", "[", 
        RowBox[{"letters", ",", " ", "symbols"}], "]"}], ",", " ", 
       RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"statesnum", " ", "=", " ", 
   RowBox[{"Range", "[", 
    RowBox[{"1", ",", " ", 
     RowBox[{"Length", "[", "states", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"seq", " ", "=", " ", 
    RowBox[{"Characters", "[", "\"\<AATG\>\"", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bases", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "\"\<A\>\"", ",", " ", "\"\<C\>\"", ",", " ", "\"\<G\>\"", ",", " ", 
     "\"\<T\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["emt", "k_"], "[", "s_", "]"}], " ", ":=", " ", 
    RowBox[{"emit", "\[LeftDoubleBracket]", 
     RowBox[{"k", ",", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"bases", ",", " ", "s"}], "]"}], "\[LeftDoubleBracket]", "1",
         "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
       "\[RightDoubleBracket]"}]}], "\[RightDoubleBracket]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"viterbi", " ", "=", " ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "seq", "]"}], " ", "+", " ", "1"}], ",", " ", 
       RowBox[{"Length", "[", "states", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"viterbi", "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", " ", "1"}], "\[RightDoubleBracket]"}], " ", "=", " ", 
   "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"viterbi", "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", " ", 
     RowBox[{"Range", "[", 
      RowBox[{"2", ",", 
       RowBox[{
        RowBox[{"Length", "[", "states", "]"}], " ", "-", " ", "1"}]}], 
      "]"}]}], "\[RightDoubleBracket]"}], " ", "=", " ", 
   RowBox[{"-", "Infinity"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"viterbi", "\[LeftDoubleBracket]", 
     RowBox[{"1", ",", " ", 
      RowBox[{"Length", "[", "states", "]"}]}], "\[RightDoubleBracket]"}], 
    " ", "=", " ", 
    RowBox[{
     SubscriptBox["v", "silent"], "[", 
     RowBox[{"1", ",", " ", 
      RowBox[{"Length", "[", "states", "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tracebacks", " ", "=", " ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "seq", "]"}], " ", "+", " ", "1"}], ",", " ", 
       RowBox[{"Length", "[", "states", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tracebacks", "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", " ", 
     RowBox[{"Range", "[", 
      RowBox[{"1", ",", " ", 
       RowBox[{"Length", "[", "states", "]"}]}], "]"}]}], 
    "\[RightDoubleBracket]"}], " ", "=", " ", 
   RowBox[{"-", "Infinity"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.576231522781892*^9, 3.576231573145845*^9}, {
   3.5762316220113573`*^9, 3.5762317081705093`*^9}, {3.576231752801874*^9, 
   3.5762317705689898`*^9}, {3.576231804820242*^9, 3.576231811813077*^9}, {
   3.576231943657214*^9, 3.576232086960134*^9}, {3.576232231965172*^9, 
   3.5762323017983093`*^9}, {3.576232361496832*^9, 3.576232371505142*^9}, {
   3.57623261825245*^9, 3.5762326296156282`*^9}, {3.576232694648097*^9, 
   3.576232765658806*^9}, {3.576232837236355*^9, 3.576232952791079*^9}, 
   3.57623306369282*^9, {3.576233099782634*^9, 3.576233100991599*^9}, {
   3.576233147803061*^9, 3.5762331521768637`*^9}, {3.576233197367334*^9, 
   3.576233230085067*^9}, {3.576235752803665*^9, 3.576235844172741*^9}, {
   3.576235973002309*^9, 3.5762359800309057`*^9}, {3.576241237328485*^9, 
   3.5762416695433197`*^9}, {3.5762417699168262`*^9, 3.576241775335661*^9}, {
   3.576241864907963*^9, 3.57624189721754*^9}, {3.57624198272184*^9, 
   3.5762419986080112`*^9}, {3.5762420703112717`*^9, 3.576242077328697*^9}, {
   3.5762421432428493`*^9, 3.576242233657918*^9}, {3.57624226661652*^9, 
   3.5762422935736933`*^9}, {3.57624234626614*^9, 3.576242349138739*^9}, {
   3.576242380982327*^9, 3.576242398632509*^9}, {3.576242431341782*^9, 
   3.576242517090815*^9}, {3.576242554935639*^9, 3.576242564457596*^9}, {
   3.576242608505249*^9, 3.576242617322967*^9}, {3.576242799563128*^9, 
   3.576242848421064*^9}, {3.5762783818021793`*^9, 3.5762787737249537`*^9}, {
   3.5762788089921227`*^9, 3.576279001254139*^9}, {3.576279273062893*^9, 
   3.576279349129065*^9}, {3.576279412584811*^9, 3.576279433948647*^9}, {
   3.5762795213735657`*^9, 3.576279688107335*^9}, {3.576279824838853*^9, 
   3.576280016983357*^9}, {3.5762824929811907`*^9, 3.576282550333477*^9}, {
   3.576282644355235*^9, 3.576282656554371*^9}, 3.576284588633626*^9, {
   3.57628477681063*^9, 3.5762849277862988`*^9}, {3.576284974951811*^9, 
   3.576285065498785*^9}, {3.576285157501752*^9, 3.5762852511659317`*^9}, {
   3.576285465692841*^9, 3.576285749205962*^9}, {3.576285854077949*^9, 
   3.576285855102365*^9}, {3.576285955506811*^9, 3.576285961497385*^9}, {
   3.5762862910476303`*^9, 3.576286306025077*^9}, 3.576286371375099*^9, {
   3.576286780376851*^9, 3.5762868117018223`*^9}, {3.576286853411252*^9, 
   3.576286971456108*^9}, {3.576436653954653*^9, 3.5764366705178843`*^9}, 
   3.576436740513665*^9, {3.57643680891542*^9, 3.576437002001378*^9}, {
   3.5764370731235*^9, 3.576437117437334*^9}, {3.576437153138342*^9, 
   3.5764371557192087`*^9}, {3.576437186511606*^9, 3.5764372290086317`*^9}, {
   3.5764372693881407`*^9, 3.57643727352094*^9}, {3.57643734713879*^9, 
   3.5764375059365053`*^9}, 3.576437540224556*^9, {3.576437603510474*^9, 
   3.576437702560759*^9}, {3.576437751576159*^9, 3.576437915787071*^9}, {
   3.576437954104725*^9, 3.576437962228757*^9}, {3.576437999488901*^9, 
   3.576438180065607*^9}, 3.576438471487076*^9, {3.576438603424181*^9, 
   3.5764386131642847`*^9}, {3.576438668915889*^9, 3.57643869243195*^9}, {
   3.5764388007956877`*^9, 3.5764388044740953`*^9}, {3.576438870018672*^9, 
   3.576438921130303*^9}, {3.576438978374888*^9, 3.576438992760704*^9}, {
   3.57643903210341*^9, 3.576439074979327*^9}, {3.576439153503166*^9, 
   3.5764391689759693`*^9}, {3.5764392177393847`*^9, 3.57643921803736*^9}, {
   3.576439304769701*^9, 3.57643930922497*^9}, {3.57643938245378*^9, 
   3.576439436511346*^9}, {3.5764395010938587`*^9, 3.576439614755972*^9}, {
   3.576439978246173*^9, 3.576440049333247*^9}, 3.576440103119952*^9, {
   3.576448959155325*^9, 3.5764490000180597`*^9}, {3.5764492216373167`*^9, 
   3.5764492306129417`*^9}, {3.576449274135668*^9, 3.576449274391611*^9}, {
   3.576449672471636*^9, 3.576449677919471*^9}, {3.576450099304471*^9, 
   3.576450110104867*^9}, 3.5764504964980707`*^9, {3.576451001612157*^9, 
   3.576451036141251*^9}, {3.576451314819057*^9, 3.5764513160434647`*^9}, {
   3.576451756453373*^9, 3.576451787277484*^9}, {3.576452548525099*^9, 
   3.576452549538286*^9}, {3.5764525915226603`*^9, 3.576452603538323*^9}, {
   3.576454690615079*^9, 3.576454691002212*^9}, 3.5764547933116913`*^9, 
   3.576518484119206*^9, {3.576518514475669*^9, 3.576518573175269*^9}, {
   3.576519580750929*^9, 3.576519581316256*^9}, {3.576521105929528*^9, 
   3.576521106942593*^9}, {3.576521190424258*^9, 3.5765211953387938`*^9}, {
   3.576522458780101*^9, 3.576522459792316*^9}, {3.576538196998444*^9, 
   3.576538198565201*^9}, 3.576538232391096*^9, {3.576538359625977*^9, 
   3.576538366791103*^9}, {3.576587371286171*^9, 3.576587371973188*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"trans", "      ", "//", "TableForm"}], "\[IndentingNewLine]", 
 RowBox[{"d", "              ", "//", "TableForm"}], "\[IndentingNewLine]", 
 RowBox[{"viterbi", "//", "TableForm"}]}], "Input",
 CellChangeTimes->{{3.576231522781892*^9, 3.576231573145845*^9}, {
   3.5762316220113573`*^9, 3.5762317081705093`*^9}, {3.576231752801874*^9, 
   3.5762317705689898`*^9}, {3.576231804820242*^9, 3.576231811813077*^9}, {
   3.576231943657214*^9, 3.576232086960134*^9}, {3.576232231965172*^9, 
   3.5762323017983093`*^9}, {3.576232361496832*^9, 3.576232371505142*^9}, {
   3.57623261825245*^9, 3.5762326296156282`*^9}, {3.576232694648097*^9, 
   3.576232765658806*^9}, {3.576232837236355*^9, 3.576232952791079*^9}, 
   3.57623306369282*^9, {3.576233099782634*^9, 3.576233100991599*^9}, {
   3.576233147803061*^9, 3.5762331521768637`*^9}, {3.576233197367334*^9, 
   3.576233230085067*^9}, {3.576235752803665*^9, 3.576235844172741*^9}, {
   3.576235973002309*^9, 3.5762359800309057`*^9}, {3.576241237328485*^9, 
   3.5762416695433197`*^9}, {3.5762417699168262`*^9, 3.576241775335661*^9}, {
   3.576241864907963*^9, 3.57624189721754*^9}, {3.57624198272184*^9, 
   3.5762419986080112`*^9}, {3.5762420703112717`*^9, 3.576242077328697*^9}, {
   3.5762421432428493`*^9, 3.576242233657918*^9}, {3.57624226661652*^9, 
   3.5762422935736933`*^9}, {3.57624234626614*^9, 3.576242349138739*^9}, {
   3.576242380982327*^9, 3.576242398632509*^9}, {3.576242431341782*^9, 
   3.576242517090815*^9}, {3.576242554935639*^9, 3.576242564457596*^9}, {
   3.576242608505249*^9, 3.576242617322967*^9}, {3.576242799563128*^9, 
   3.576242848421064*^9}, {3.5762783818021793`*^9, 3.5762787737249537`*^9}, {
   3.5762788089921227`*^9, 3.576279001254139*^9}, {3.576279273062893*^9, 
   3.576279349129065*^9}, {3.576279412584811*^9, 3.576279433948647*^9}, {
   3.5762795213735657`*^9, 3.576279688107335*^9}, {3.576279824838853*^9, 
   3.576280016983357*^9}, {3.5762824929811907`*^9, 3.576282550333477*^9}, {
   3.576282644355235*^9, 3.576282656554371*^9}, 3.576284588633626*^9, {
   3.57628477681063*^9, 3.5762849277862988`*^9}, {3.576284974951811*^9, 
   3.576285065498785*^9}, {3.576285157501752*^9, 3.5762852511659317`*^9}, {
   3.576285465692841*^9, 3.576285749205962*^9}, {3.576285854077949*^9, 
   3.576285855102365*^9}, {3.576285955506811*^9, 3.576285961497385*^9}, {
   3.5762862910476303`*^9, 3.576286306025077*^9}, 3.576286371375099*^9, {
   3.576286780376851*^9, 3.5762868117018223`*^9}, {3.576286853411252*^9, 
   3.576286971456108*^9}, {3.576436653954653*^9, 3.5764366705178843`*^9}, 
   3.576436740513665*^9, {3.57643680891542*^9, 3.576437002001378*^9}, {
   3.5764370731235*^9, 3.576437117437334*^9}, {3.576437153138342*^9, 
   3.5764371557192087`*^9}, {3.576437186511606*^9, 3.5764372290086317`*^9}, {
   3.5764372693881407`*^9, 3.57643727352094*^9}, {3.57643734713879*^9, 
   3.5764375059365053`*^9}, 3.576437540224556*^9, {3.576437603510474*^9, 
   3.576437702560759*^9}, {3.576437751576159*^9, 3.576437915787071*^9}, {
   3.576437954104725*^9, 3.576437962228757*^9}, {3.576437999488901*^9, 
   3.576438180065607*^9}, 3.576438471487076*^9, {3.576438603424181*^9, 
   3.5764386131642847`*^9}, {3.576438668915889*^9, 3.57643869243195*^9}, {
   3.5764388007956877`*^9, 3.5764388044740953`*^9}, {3.576438870018672*^9, 
   3.576438921130303*^9}, {3.576438978374888*^9, 3.576438992760704*^9}, {
   3.57643903210341*^9, 3.576439074979327*^9}, {3.576439153503166*^9, 
   3.5764391689759693`*^9}, {3.5764392177393847`*^9, 3.57643921803736*^9}, {
   3.576439304769701*^9, 3.57643930922497*^9}, {3.57643938245378*^9, 
   3.576439436511346*^9}, {3.5764395010938587`*^9, 3.576439614755972*^9}, {
   3.576439978246173*^9, 3.576440049333247*^9}, 3.576440103119952*^9, {
   3.576448959155325*^9, 3.5764490000180597`*^9}, {3.5764492216373167`*^9, 
   3.5764492306129417`*^9}, {3.576449274135668*^9, 3.576449274391611*^9}, {
   3.576449672471636*^9, 3.576449677919471*^9}, {3.576450099304471*^9, 
   3.576450110104867*^9}, 3.5764504964980707`*^9, {3.576451001612157*^9, 
   3.576451059555402*^9}, {3.576451677970192*^9, 3.5764516829105253`*^9}, {
   3.576451768766696*^9, 3.5764517698859463`*^9}, {3.5764536938182783`*^9, 
   3.5764537020903587`*^9}, {3.576520499543045*^9, 3.576520503302869*^9}, {
   3.576520928389584*^9, 3.5765209334900827`*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {"0.`", "0.0725193`", "0.163763`", "0.1788242`", "0.0754545`", 
     "0.132205`", "0.1267006`", "0.122638`", "0.127895`", "0.`"},
    {"0.`", "0.1762237`", "0.2682517`", "0.4170629`", "0.1174825`", 
     "0.0035964`", "0.0054745`", "0.0085104`", "0.0023976`", "0.001`"},
    {"0.`", "0.1672435`", "0.3599201`", "0.267984`", "0.1838722`", 
     "0.0034131`", "0.0073453`", "0.005469`", "0.0037524`", "0.001`"},
    {"0.`", "0.1576223`", "0.3318881`", "0.3671328`", "0.1223776`", 
     "0.0032167`", "0.0067732`", "0.0074915`", "0.0024975`", "0.001`"},
    {"0.`", "0.0773426`", "0.3475514`", "0.375944`", "0.1781818`", 
     "0.0015784`", "0.0070929`", "0.0076723`", "0.0036363`", "0.001`"},
    {"0.`", "0.0002997`", "0.0002047`", "0.0002837`", "0.0002097`", 
     "0.2994005`", "0.2045904`", "0.2844305`", "0.2095804`", "0.001`"},
    {"0.`", "0.0003216`", "0.0002977`", "0.0000769`", "0.0003016`", 
     "0.3213566`", "0.2974045`", "0.0778441`", "0.3013966`", "0.001`"},
    {"0.`", "0.0001768`", "0.0002387`", "0.0002917`", "0.0002917`", 
     "0.1766463`", "0.2385224`", "0.2914165`", "0.2914155`", "0.001`"},
    {"0.`", "0.0002477`", "0.0002457`", "0.0002977`", "0.0002077`", 
     "0.2475044`", "0.2455084`", "0.2974035`", "0.2075844`", "0.001`"},
    {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.576451043717749*^9, 3.576451059847576*^9}, 
   3.5764512753027*^9, 3.5764513238648233`*^9, 3.576451561522612*^9, 
   3.576451602774034*^9, 3.5764516856660347`*^9, 3.576451791052677*^9, 
   3.57645194885413*^9, 3.576452079979869*^9, 3.5764521223161917`*^9, 
   3.576452290162773*^9, 3.5764524611494513`*^9, 3.576452552855199*^9, {
   3.576452596683086*^9, 3.5764526065902357`*^9}, 3.576453358073387*^9, 
   3.57645344709221*^9, {3.576454103810611*^9, 3.576454127952723*^9}, {
   3.5764546736047077`*^9, 3.576454693508415*^9}, 3.576454795673049*^9, 
   3.5765195411836357`*^9, 3.576519584226111*^9, {3.576519769823505*^9, 
   3.576519793287238*^9}, {3.576520244915914*^9, 3.576520269639835*^9}, 
   3.5765203007415037`*^9, 3.5765205035595503`*^9, {3.576520711836939*^9, 
   3.5765207784141006`*^9}, {3.576520832552177*^9, 3.576520842853726*^9}, {
   3.5765208925854797`*^9, 3.576520929751375*^9}, {3.576521149026637*^9, 
   3.576521173819173*^9}, 3.576521203850312*^9, 3.576521261918446*^9, 
   3.5765213116153183`*^9, 3.5765213845524807`*^9, 3.576522366390229*^9, 
   3.576522399961431*^9, {3.576522450092251*^9, 3.576522484039336*^9}, 
   3.576522520272359*^9, 3.5765370770697937`*^9, 3.57653820179541*^9, 
   3.576538249674168*^9, 3.576538295082938*^9, 3.5765383694198637`*^9, 
   3.576587379874942*^9, 3.57663497229678*^9}],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\".\"\>", "\<\"s\"\>", "0.`", "0.0725193`", "0.163763`", "0.1788242`",
      "0.0754545`", "0.132205`", "0.1267006`", "0.122638`", "0.127895`", 
     "0.`"},
    {"\<\"A\"\>", "\<\"+\"\>", "0.`", "0.1762237`", "0.2682517`", 
     "0.4170629`", "0.1174825`", "0.0035964`", "0.0054745`", "0.0085104`", 
     "0.0023976`", "0.001`"},
    {"\<\"C\"\>", "\<\"+\"\>", "0.`", "0.1672435`", "0.3599201`", "0.267984`",
      "0.1838722`", "0.0034131`", "0.0073453`", "0.005469`", "0.0037524`", 
     "0.001`"},
    {"\<\"G\"\>", "\<\"+\"\>", "0.`", "0.1576223`", "0.3318881`", 
     "0.3671328`", "0.1223776`", "0.0032167`", "0.0067732`", "0.0074915`", 
     "0.0024975`", "0.001`"},
    {"\<\"T\"\>", "\<\"+\"\>", "0.`", "0.0773426`", "0.3475514`", "0.375944`",
      "0.1781818`", "0.0015784`", "0.0070929`", "0.0076723`", "0.0036363`", 
     "0.001`"},
    {"\<\"A\"\>", "\<\"-\"\>", "0.`", "0.0002997`", "0.0002047`", 
     "0.0002837`", "0.0002097`", "0.2994005`", "0.2045904`", "0.2844305`", 
     "0.2095804`", "0.001`"},
    {"\<\"C\"\>", "\<\"-\"\>", "0.`", "0.0003216`", "0.0002977`", 
     "0.0000769`", "0.0003016`", "0.3213566`", "0.2974045`", "0.0778441`", 
     "0.3013966`", "0.001`"},
    {"\<\"G\"\>", "\<\"-\"\>", "0.`", "0.0001768`", "0.0002387`", 
     "0.0002917`", "0.0002917`", "0.1766463`", "0.2385224`", "0.2914165`", 
     "0.2914155`", "0.001`"},
    {"\<\"T\"\>", "\<\"-\"\>", "0.`", "0.0002477`", "0.0002457`", 
     "0.0002977`", "0.0002077`", "0.2475044`", "0.2455084`", "0.2974035`", 
     "0.2075844`", "0.001`"},
    {"\<\".\"\>", "\<\"e\"\>", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
     "0.`", "0.`", "0.`", "0.`"}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.576451043717749*^9, 3.576451059847576*^9}, 
   3.5764512753027*^9, 3.5764513238648233`*^9, 3.576451561522612*^9, 
   3.576451602774034*^9, 3.5764516856660347`*^9, 3.576451791052677*^9, 
   3.57645194885413*^9, 3.576452079979869*^9, 3.5764521223161917`*^9, 
   3.576452290162773*^9, 3.5764524611494513`*^9, 3.576452552855199*^9, {
   3.576452596683086*^9, 3.5764526065902357`*^9}, 3.576453358073387*^9, 
   3.57645344709221*^9, {3.576454103810611*^9, 3.576454127952723*^9}, {
   3.5764546736047077`*^9, 3.576454693508415*^9}, 3.576454795673049*^9, 
   3.5765195411836357`*^9, 3.576519584226111*^9, {3.576519769823505*^9, 
   3.576519793287238*^9}, {3.576520244915914*^9, 3.576520269639835*^9}, 
   3.5765203007415037`*^9, 3.5765205035595503`*^9, {3.576520711836939*^9, 
   3.5765207784141006`*^9}, {3.576520832552177*^9, 3.576520842853726*^9}, {
   3.5765208925854797`*^9, 3.576520929751375*^9}, {3.576521149026637*^9, 
   3.576521173819173*^9}, 3.576521203850312*^9, 3.576521261918446*^9, 
   3.5765213116153183`*^9, 3.5765213845524807`*^9, 3.576522366390229*^9, 
   3.576522399961431*^9, {3.576522450092251*^9, 3.576522484039336*^9}, 
   3.576522520272359*^9, 3.5765370770697937`*^9, 3.57653820179541*^9, 
   3.576538249674168*^9, 3.576538295082938*^9, 3.5765383694198637`*^9, 
   3.576587379874942*^9, 3.576634972301593*^9}],

Cell[BoxData[
 TagBox[GridBox[{
    {"0", 
     RowBox[{"-", "\[Infinity]"}], 
     RowBox[{"-", "\[Infinity]"}], 
     RowBox[{"-", "\[Infinity]"}], 
     RowBox[{"-", "\[Infinity]"}], 
     RowBox[{"-", "\[Infinity]"}], 
     RowBox[{"-", "\[Infinity]"}], 
     RowBox[{"-", "\[Infinity]"}], 
     RowBox[{"-", "\[Infinity]"}], 
     RowBox[{"-", "\[Infinity]"}]},
    {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
    {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
    {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
    {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0"}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.576451043717749*^9, 3.576451059847576*^9}, 
   3.5764512753027*^9, 3.5764513238648233`*^9, 3.576451561522612*^9, 
   3.576451602774034*^9, 3.5764516856660347`*^9, 3.576451791052677*^9, 
   3.57645194885413*^9, 3.576452079979869*^9, 3.5764521223161917`*^9, 
   3.576452290162773*^9, 3.5764524611494513`*^9, 3.576452552855199*^9, {
   3.576452596683086*^9, 3.5764526065902357`*^9}, 3.576453358073387*^9, 
   3.57645344709221*^9, {3.576454103810611*^9, 3.576454127952723*^9}, {
   3.5764546736047077`*^9, 3.576454693508415*^9}, 3.576454795673049*^9, 
   3.5765195411836357`*^9, 3.576519584226111*^9, {3.576519769823505*^9, 
   3.576519793287238*^9}, {3.576520244915914*^9, 3.576520269639835*^9}, 
   3.5765203007415037`*^9, 3.5765205035595503`*^9, {3.576520711836939*^9, 
   3.5765207784141006`*^9}, {3.576520832552177*^9, 3.576520842853726*^9}, {
   3.5765208925854797`*^9, 3.576520929751375*^9}, {3.576521149026637*^9, 
   3.576521173819173*^9}, 3.576521203850312*^9, 3.576521261918446*^9, 
   3.5765213116153183`*^9, 3.5765213845524807`*^9, 3.576522366390229*^9, 
   3.576522399961431*^9, {3.576522450092251*^9, 3.576522484039336*^9}, 
   3.576522520272359*^9, 3.5765370770697937`*^9, 3.57653820179541*^9, 
   3.576538249674168*^9, 3.576538295082938*^9, 3.5765383694198637`*^9, 
   3.576587379874942*^9, 3.576634972305316*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["v", "emitting"], "[", 
     RowBox[{"i_", ",", " ", "k_"}], "]"}], " ", ":=", "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Log", "[", 
        RowBox[{
         SubscriptBox["emt", "k"], "[", 
         RowBox[{"seq", "\[LeftDoubleBracket]", 
          RowBox[{"i", " ", "-", " ", "1"}], "\[RightDoubleBracket]"}], "]"}],
         "]"}], "/.", " ", 
       RowBox[{"{", 
        RowBox[{"Indeterminate", " ", "\[Rule]", " ", 
         RowBox[{"-", "Infinity"}]}], "}"}]}], ")"}], "  ", "+", " ", 
     RowBox[{"Max", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"j", " ", "\[Function]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Log", "[", 
              RowBox[{"trans", "\[LeftDoubleBracket]", 
               RowBox[{"j", ",", " ", "k"}], "\[RightDoubleBracket]"}], "]"}],
              "/.", 
             RowBox[{"{", 
              RowBox[{"Indeterminate", "\[Rule]", 
               RowBox[{"-", "Infinity"}]}], "}"}]}], ")"}], " ", "+", " ", 
           RowBox[{"viterbi", "\[LeftDoubleBracket]", 
            RowBox[{
             RowBox[{"i", " ", "-", " ", "1"}], ",", " ", "j"}], 
            "\[RightDoubleBracket]"}]}], ")"}]}], ")"}], " ", "/@", " ", 
       "statesnum"}], "]"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]",
    "\t\t"}]}]], "Input",
 CellChangeTimes->{{3.576231522781892*^9, 3.576231573145845*^9}, {
   3.5762316220113573`*^9, 3.5762317081705093`*^9}, {3.576231752801874*^9, 
   3.5762317705689898`*^9}, {3.576231804820242*^9, 3.576231811813077*^9}, {
   3.576231943657214*^9, 3.576232086960134*^9}, {3.576232231965172*^9, 
   3.5762323017983093`*^9}, {3.576232361496832*^9, 3.576232371505142*^9}, {
   3.57623261825245*^9, 3.5762326296156282`*^9}, {3.576232694648097*^9, 
   3.576232765658806*^9}, {3.576232837236355*^9, 3.576232952791079*^9}, 
   3.57623306369282*^9, {3.576233099782634*^9, 3.576233100991599*^9}, {
   3.576233147803061*^9, 3.5762331521768637`*^9}, {3.576233197367334*^9, 
   3.576233230085067*^9}, {3.576235752803665*^9, 3.576235844172741*^9}, {
   3.576235973002309*^9, 3.5762359800309057`*^9}, {3.576241237328485*^9, 
   3.5762416695433197`*^9}, {3.5762417699168262`*^9, 3.576241775335661*^9}, {
   3.576241864907963*^9, 3.57624189721754*^9}, {3.57624198272184*^9, 
   3.5762419986080112`*^9}, {3.5762420703112717`*^9, 3.576242077328697*^9}, {
   3.5762421432428493`*^9, 3.576242233657918*^9}, {3.57624226661652*^9, 
   3.5762422935736933`*^9}, {3.57624234626614*^9, 3.576242349138739*^9}, {
   3.576242380982327*^9, 3.576242398632509*^9}, {3.576242431341782*^9, 
   3.576242517090815*^9}, {3.576242554935639*^9, 3.576242564457596*^9}, {
   3.576242608505249*^9, 3.576242617322967*^9}, {3.576242799563128*^9, 
   3.576242848421064*^9}, {3.5762783818021793`*^9, 3.5762787737249537`*^9}, {
   3.5762788089921227`*^9, 3.576279001254139*^9}, {3.576279273062893*^9, 
   3.576279349129065*^9}, {3.576279412584811*^9, 3.576279433948647*^9}, {
   3.5762795213735657`*^9, 3.576279688107335*^9}, {3.576279824838853*^9, 
   3.576280016983357*^9}, {3.5762824929811907`*^9, 3.576282550333477*^9}, {
   3.576282644355235*^9, 3.576282656554371*^9}, 3.576284588633626*^9, {
   3.57628477681063*^9, 3.5762849277862988`*^9}, {3.576284974951811*^9, 
   3.576285065498785*^9}, {3.576285157501752*^9, 3.5762852511659317`*^9}, {
   3.576285465692841*^9, 3.576285749205962*^9}, {3.576285854077949*^9, 
   3.576285855102365*^9}, {3.576285955506811*^9, 3.576285961497385*^9}, {
   3.5762862910476303`*^9, 3.576286306025077*^9}, 3.576286371375099*^9, {
   3.576286780376851*^9, 3.5762868117018223`*^9}, {3.576286853411252*^9, 
   3.576286971456108*^9}, {3.576436653954653*^9, 3.5764366705178843`*^9}, 
   3.576436740513665*^9, {3.57643680891542*^9, 3.576437002001378*^9}, {
   3.5764370731235*^9, 3.576437117437334*^9}, {3.576437153138342*^9, 
   3.5764371557192087`*^9}, {3.576437186511606*^9, 3.5764372290086317`*^9}, {
   3.5764372693881407`*^9, 3.57643727352094*^9}, {3.57643734713879*^9, 
   3.5764375059365053`*^9}, 3.576437540224556*^9, {3.576437603510474*^9, 
   3.576437702560759*^9}, {3.576437751576159*^9, 3.576437915787071*^9}, {
   3.576437954104725*^9, 3.576437962228757*^9}, {3.576437999488901*^9, 
   3.576438180065607*^9}, 3.576438471487076*^9, {3.576438603424181*^9, 
   3.5764386131642847`*^9}, {3.576438668915889*^9, 3.57643869243195*^9}, {
   3.5764388007956877`*^9, 3.5764388044740953`*^9}, {3.576438870018672*^9, 
   3.576438921130303*^9}, {3.576438978374888*^9, 3.576438992760704*^9}, {
   3.57643903210341*^9, 3.576439074979327*^9}, {3.576439153503166*^9, 
   3.5764391689759693`*^9}, {3.5764392177393847`*^9, 3.57643921803736*^9}, {
   3.576439304769701*^9, 3.57643930922497*^9}, {3.57643938245378*^9, 
   3.576439436511346*^9}, {3.5764395010938587`*^9, 3.576439614755972*^9}, {
   3.576439978246173*^9, 3.576440049333247*^9}, 3.576440103119952*^9, {
   3.576448959155325*^9, 3.5764490558118277`*^9}, {3.576449086707109*^9, 
   3.576449212547945*^9}, {3.576449277983527*^9, 3.576449469508285*^9}, {
   3.576449639370523*^9, 3.5764499348336067`*^9}, {3.576450001685404*^9, 
   3.5764500697363777`*^9}, {3.576450190229582*^9, 3.5764501910283327`*^9}, {
   3.576450232706937*^9, 3.576450269096354*^9}, {3.576450314968545*^9, 
   3.576450417685918*^9}, {3.576450453090912*^9, 3.5764505127451344`*^9}, {
   3.5764505503367243`*^9, 3.5764505905867243`*^9}, {3.576450642410302*^9, 
   3.576450729333108*^9}, {3.576450827793943*^9, 3.576450830609681*^9}, {
   3.5764508705753202`*^9, 3.57645092024962*^9}, {3.5764509564138308`*^9, 
   3.576450974365533*^9}, {3.5764512708159847`*^9, 3.5764512725516443`*^9}, {
   3.576451390460718*^9, 3.576451395335349*^9}, {3.576451556273258*^9, 
   3.576451557801208*^9}, {3.576452072161045*^9, 3.576452119024561*^9}, {
   3.57645216637527*^9, 3.5764522182356653`*^9}, {3.5764522763470993`*^9, 
   3.5764522881697407`*^9}, {3.5764523830418043`*^9, 3.57645240695992*^9}, {
   3.576452447334426*^9, 3.576452478330711*^9}, 3.576453240493127*^9, {
   3.576454097406117*^9, 3.576454099243663*^9}, {3.576519666259893*^9, 
   3.576519695236824*^9}, {3.576519740225218*^9, 3.5765197907634993`*^9}, {
   3.5765211111753893`*^9, 3.576521121618915*^9}, {3.576521164727783*^9, 
   3.576521170418125*^9}, {3.576521227412161*^9, 3.576521258663356*^9}, {
   3.576521289683889*^9, 3.576521307202739*^9}, {3.5765213751753597`*^9, 
   3.576521377534874*^9}, {3.5765223908985043`*^9, 3.576522397415346*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["v", "silent"], "[", 
     RowBox[{"i_", ",", " ", "k_"}], "]"}], " ", ":=", "\[IndentingNewLine]", 
    
    RowBox[{"Max", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"j", " ", "\[Function]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Log", "[", 
             RowBox[{"trans", "\[LeftDoubleBracket]", 
              RowBox[{"j", ",", " ", "k"}], "\[RightDoubleBracket]"}], "]"}], 
            "/.", 
            RowBox[{"{", 
             RowBox[{"Indeterminate", " ", "\[Rule]", " ", 
              RowBox[{"-", "Infinity"}]}], "}"}]}], ")"}], " ", "+", " ", 
          RowBox[{"viterbi", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", " ", "j"}], "\[RightDoubleBracket]"}]}], ")"}]}],
        ")"}], " ", "/@", " ", 
      RowBox[{"Select", "[", 
       RowBox[{"statesnum", ",", " ", 
        RowBox[{
         RowBox[{"#", " ", "\[NotEqual]", " ", "k"}], "&"}]}], "]"}]}], 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.576231522781892*^9, 3.576231573145845*^9}, {
   3.5762316220113573`*^9, 3.5762317081705093`*^9}, {3.576231752801874*^9, 
   3.5762317705689898`*^9}, {3.576231804820242*^9, 3.576231811813077*^9}, {
   3.576231943657214*^9, 3.576232086960134*^9}, {3.576232231965172*^9, 
   3.5762323017983093`*^9}, {3.576232361496832*^9, 3.576232371505142*^9}, {
   3.57623261825245*^9, 3.5762326296156282`*^9}, {3.576232694648097*^9, 
   3.576232765658806*^9}, {3.576232837236355*^9, 3.576232952791079*^9}, 
   3.57623306369282*^9, {3.576233099782634*^9, 3.576233100991599*^9}, {
   3.576233147803061*^9, 3.5762331521768637`*^9}, {3.576233197367334*^9, 
   3.576233230085067*^9}, {3.576235752803665*^9, 3.576235844172741*^9}, {
   3.576235973002309*^9, 3.5762359800309057`*^9}, {3.576241237328485*^9, 
   3.5762416695433197`*^9}, {3.5762417699168262`*^9, 3.576241775335661*^9}, {
   3.576241864907963*^9, 3.57624189721754*^9}, {3.57624198272184*^9, 
   3.5762419986080112`*^9}, {3.5762420703112717`*^9, 3.576242077328697*^9}, {
   3.5762421432428493`*^9, 3.576242233657918*^9}, {3.57624226661652*^9, 
   3.5762422935736933`*^9}, {3.57624234626614*^9, 3.576242349138739*^9}, {
   3.576242380982327*^9, 3.576242398632509*^9}, {3.576242431341782*^9, 
   3.576242517090815*^9}, {3.576242554935639*^9, 3.576242564457596*^9}, {
   3.576242608505249*^9, 3.576242617322967*^9}, {3.576242799563128*^9, 
   3.576242848421064*^9}, {3.5762783818021793`*^9, 3.5762787737249537`*^9}, {
   3.5762788089921227`*^9, 3.576279001254139*^9}, {3.576279273062893*^9, 
   3.576279349129065*^9}, {3.576279412584811*^9, 3.576279433948647*^9}, {
   3.5762795213735657`*^9, 3.576279688107335*^9}, {3.576279824838853*^9, 
   3.576280016983357*^9}, {3.5762824929811907`*^9, 3.576282550333477*^9}, {
   3.576282644355235*^9, 3.576282656554371*^9}, 3.576284588633626*^9, {
   3.57628477681063*^9, 3.5762849277862988`*^9}, {3.576284974951811*^9, 
   3.576285065498785*^9}, {3.576285157501752*^9, 3.5762852511659317`*^9}, {
   3.576285465692841*^9, 3.576285749205962*^9}, {3.576285854077949*^9, 
   3.576285855102365*^9}, {3.576285955506811*^9, 3.576285961497385*^9}, {
   3.5762862910476303`*^9, 3.576286306025077*^9}, 3.576286371375099*^9, {
   3.576286780376851*^9, 3.5762868117018223`*^9}, {3.576286853411252*^9, 
   3.576286971456108*^9}, {3.576436653954653*^9, 3.5764366705178843`*^9}, 
   3.576436740513665*^9, {3.57643680891542*^9, 3.576437002001378*^9}, {
   3.5764370731235*^9, 3.576437117437334*^9}, {3.576437153138342*^9, 
   3.5764371557192087`*^9}, {3.576437186511606*^9, 3.5764372290086317`*^9}, {
   3.5764372693881407`*^9, 3.57643727352094*^9}, {3.57643734713879*^9, 
   3.5764375059365053`*^9}, 3.576437540224556*^9, {3.576437603510474*^9, 
   3.576437702560759*^9}, {3.576437751576159*^9, 3.576437915787071*^9}, {
   3.576437954104725*^9, 3.576437962228757*^9}, {3.576437999488901*^9, 
   3.576438180065607*^9}, 3.576438471487076*^9, {3.576438603424181*^9, 
   3.5764386131642847`*^9}, {3.576438668915889*^9, 3.57643869243195*^9}, {
   3.5764388007956877`*^9, 3.5764388044740953`*^9}, {3.576438870018672*^9, 
   3.576438921130303*^9}, {3.576438978374888*^9, 3.576438992760704*^9}, {
   3.57643903210341*^9, 3.576439074979327*^9}, {3.576439153503166*^9, 
   3.5764391689759693`*^9}, {3.5764392177393847`*^9, 3.57643921803736*^9}, {
   3.576439304769701*^9, 3.57643930922497*^9}, {3.57643938245378*^9, 
   3.576439436511346*^9}, {3.5764395010938587`*^9, 3.576439614755972*^9}, {
   3.576439978246173*^9, 3.576440049333247*^9}, 3.576440103119952*^9, {
   3.576448959155325*^9, 3.5764490558118277`*^9}, {3.576449086707109*^9, 
   3.576449212547945*^9}, {3.576449277983527*^9, 3.576449469508285*^9}, {
   3.576449639370523*^9, 3.5764499348336067`*^9}, {3.576450001685404*^9, 
   3.5764500697363777`*^9}, {3.576450190229582*^9, 3.5764501910283327`*^9}, {
   3.576450232706937*^9, 3.576450269096354*^9}, {3.576450314968545*^9, 
   3.576450417685918*^9}, {3.576450453090912*^9, 3.5764505127451344`*^9}, {
   3.5764505503367243`*^9, 3.5764505905867243`*^9}, {3.576450642410302*^9, 
   3.576450729333108*^9}, {3.576450827793943*^9, 3.576450830609681*^9}, {
   3.5764508705753202`*^9, 3.57645092024962*^9}, {3.5764509564138308`*^9, 
   3.576450974365533*^9}, {3.5764512708159847`*^9, 3.5764512725516443`*^9}, {
   3.576451390460718*^9, 3.576451401219643*^9}, {3.5764514381105137`*^9, 
   3.576451465922368*^9}, {3.576451597314309*^9, 3.576451600224221*^9}, {
   3.57645181181427*^9, 3.5764518293050947`*^9}, {3.576451873380376*^9, 
   3.576451887059626*^9}, {3.576451935598922*^9, 3.5764519451790943`*^9}, {
   3.576452283363377*^9, 3.576452285634338*^9}, 3.576452380013556*^9, {
   3.57651976642863*^9, 3.576519766670854*^9}, {3.576521083086965*^9, 
   3.576521095674572*^9}, {3.57652128100951*^9, 3.576521287024971*^9}, {
   3.576521362586544*^9, 3.576521373014779*^9}, {3.5765215263586273`*^9, 
   3.576521688324519*^9}, {3.576521730649311*^9, 3.576521734649881*^9}, {
   3.576521793538756*^9, 3.57652179673071*^9}, {3.576521866023594*^9, 
   3.576521866967412*^9}, {3.576521898123743*^9, 3.576522050767247*^9}, {
   3.5765220933066263`*^9, 3.576522123308628*^9}, {3.5765221824065723`*^9, 
   3.5765222600462303`*^9}, {3.57652229264467*^9, 3.576522363895393*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Indeterminate", " ", "/.", " ", 
  RowBox[{"{", 
   RowBox[{"Indeterminate", " ", "\[Rule]", " ", 
    RowBox[{"-", "Infinity"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.576231522781892*^9, 3.576231573145845*^9}, {
   3.5762316220113573`*^9, 3.5762317081705093`*^9}, {3.576231752801874*^9, 
   3.5762317705689898`*^9}, {3.576231804820242*^9, 3.576231811813077*^9}, {
   3.576231943657214*^9, 3.576232086960134*^9}, {3.576232231965172*^9, 
   3.5762323017983093`*^9}, {3.576232361496832*^9, 3.576232371505142*^9}, {
   3.57623261825245*^9, 3.5762326296156282`*^9}, {3.576232694648097*^9, 
   3.576232765658806*^9}, {3.576232837236355*^9, 3.576232952791079*^9}, 
   3.57623306369282*^9, {3.576233099782634*^9, 3.576233100991599*^9}, {
   3.576233147803061*^9, 3.5762331521768637`*^9}, {3.576233197367334*^9, 
   3.576233230085067*^9}, {3.576235752803665*^9, 3.576235844172741*^9}, {
   3.576235973002309*^9, 3.5762359800309057`*^9}, {3.576241237328485*^9, 
   3.5762416695433197`*^9}, {3.5762417699168262`*^9, 3.576241775335661*^9}, {
   3.576241864907963*^9, 3.57624189721754*^9}, {3.57624198272184*^9, 
   3.5762419986080112`*^9}, {3.5762420703112717`*^9, 3.576242077328697*^9}, {
   3.5762421432428493`*^9, 3.576242233657918*^9}, {3.57624226661652*^9, 
   3.5762422935736933`*^9}, {3.57624234626614*^9, 3.576242349138739*^9}, {
   3.576242380982327*^9, 3.576242398632509*^9}, {3.576242431341782*^9, 
   3.576242517090815*^9}, {3.576242554935639*^9, 3.576242564457596*^9}, {
   3.576242608505249*^9, 3.576242617322967*^9}, {3.576242799563128*^9, 
   3.576242848421064*^9}, {3.5762783818021793`*^9, 3.5762787737249537`*^9}, {
   3.5762788089921227`*^9, 3.576279001254139*^9}, {3.576279273062893*^9, 
   3.576279349129065*^9}, {3.576279412584811*^9, 3.576279433948647*^9}, {
   3.5762795213735657`*^9, 3.576279688107335*^9}, {3.576279824838853*^9, 
   3.576280016983357*^9}, {3.5762824929811907`*^9, 3.576282550333477*^9}, {
   3.576282644355235*^9, 3.576282656554371*^9}, 3.576284588633626*^9, {
   3.57628477681063*^9, 3.5762849277862988`*^9}, {3.576284974951811*^9, 
   3.576285065498785*^9}, {3.576285157501752*^9, 3.5762852511659317`*^9}, {
   3.576285465692841*^9, 3.576285749205962*^9}, {3.576285854077949*^9, 
   3.576285855102365*^9}, {3.576285955506811*^9, 3.576285961497385*^9}, {
   3.5762862910476303`*^9, 3.576286306025077*^9}, 3.576286371375099*^9, {
   3.576286780376851*^9, 3.5762868117018223`*^9}, {3.576286853411252*^9, 
   3.576286971456108*^9}, {3.576436653954653*^9, 3.5764366705178843`*^9}, 
   3.576436740513665*^9, {3.57643680891542*^9, 3.576437002001378*^9}, {
   3.5764370731235*^9, 3.576437117437334*^9}, {3.576437153138342*^9, 
   3.5764371557192087`*^9}, {3.576437186511606*^9, 3.5764372290086317`*^9}, {
   3.5764372693881407`*^9, 3.57643727352094*^9}, {3.57643734713879*^9, 
   3.5764375059365053`*^9}, 3.576437540224556*^9, {3.576437603510474*^9, 
   3.576437702560759*^9}, {3.576437751576159*^9, 3.576437915787071*^9}, {
   3.576437954104725*^9, 3.576437962228757*^9}, {3.576437999488901*^9, 
   3.576438180065607*^9}, 3.576438471487076*^9, {3.576438603424181*^9, 
   3.5764386131642847`*^9}, {3.576438668915889*^9, 3.57643869243195*^9}, {
   3.5764388007956877`*^9, 3.5764388044740953`*^9}, {3.576438870018672*^9, 
   3.576438921130303*^9}, {3.576438978374888*^9, 3.576438992760704*^9}, {
   3.57643903210341*^9, 3.576439074979327*^9}, {3.576439153503166*^9, 
   3.5764391689759693`*^9}, {3.5764392177393847`*^9, 3.57643921803736*^9}, {
   3.576439304769701*^9, 3.57643930922497*^9}, {3.57643938245378*^9, 
   3.576439436511346*^9}, {3.5764395010938587`*^9, 3.576439614755972*^9}, {
   3.576439978246173*^9, 3.576440049333247*^9}, 3.576440103119952*^9, {
   3.576448959155325*^9, 3.5764489866636543`*^9}, {3.576450291070813*^9, 
   3.576450292688078*^9}, {3.576450769042932*^9, 3.576450781357539*^9}, {
   3.5764513863532467`*^9, 3.576451424630412*^9}, {3.576451469717288*^9, 
   3.576451515979691*^9}, {3.5764515780516367`*^9, 3.5764515885062847`*^9}, {
   3.576452577724828*^9, 3.576452580790957*^9}, {3.5764526257436*^9, 
   3.576452659069641*^9}, {3.576453411920395*^9, 3.576453431870543*^9}, {
   3.576454116252582*^9, 3.576454125043366*^9}, {3.5764546214134493`*^9, 
   3.576454626345521*^9}, {3.576454670104226*^9, 3.576454670568306*^9}, 
   3.576519475945836*^9, {3.576521343495366*^9, 3.576521354019025*^9}}],

Cell[BoxData[
 RowBox[{"-", "\[Infinity]"}]], "Output",
 CellChangeTimes->{{3.576521350128326*^9, 3.576521354441687*^9}, 
   3.576521384648283*^9, 3.576522366472907*^9, 3.5765224000587883`*^9, {
   3.576522450215732*^9, 3.576522484151722*^9}, 3.576522520376069*^9, 
   3.576537077260303*^9, 3.576538201879319*^9, 3.576538250025895*^9, 
   3.576538295416992*^9, 3.576538369518858*^9, 3.5765873799829273`*^9, 
   3.576634972415592*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["p", "emitting"], "[", 
     RowBox[{"i_", ",", " ", "k_"}], "]"}], " ", ":=", "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "#", "]"}], " ", ">", " ", "0"}], ",", " ", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"#", ",", " ", 
           RowBox[{"Max", "[", "#", "]"}]}], "]"}], "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", " ", 
        RowBox[{"-", "Infinity"}]}], "]"}], " ", "&"}], "@", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"j", " ", "\[Function]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Log", "[", 
              RowBox[{"trans", "\[LeftDoubleBracket]", 
               RowBox[{"j", ",", " ", "k"}], "\[RightDoubleBracket]"}], "]"}],
              "/.", 
             RowBox[{"{", 
              RowBox[{"Indeterminate", " ", "\[Rule]", " ", 
               RowBox[{"-", "Infinity"}]}], "}"}]}], ")"}], " ", "+", " ", 
           RowBox[{"viterbi", "\[LeftDoubleBracket]", 
            RowBox[{
             RowBox[{"i", " ", "-", " ", "1"}], ",", " ", "j"}], 
            "\[RightDoubleBracket]"}]}], ")"}]}], ")"}], " ", "/@", " ", 
       "statesnum"}], ")"}]}]}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.576518587375413*^9, 3.576518600322653*^9}, {
   3.576518680188675*^9, 3.576518691818865*^9}, {3.576518811347604*^9, 
   3.5765188120166903`*^9}, {3.5765188865681763`*^9, 3.5765188994591303`*^9}, 
   3.576518994386566*^9, {3.5765191496075907`*^9, 3.576519181863401*^9}, {
   3.5765192584413013`*^9, 3.5765192805150843`*^9}, 3.576519851267743*^9, {
   3.576520687179708*^9, 3.5765207090685673`*^9}, {3.57652075189543*^9, 
   3.5765207734820137`*^9}, {3.576520900616448*^9, 3.576520908188087*^9}, {
   3.576520987086315*^9, 3.576521013644875*^9}, {3.576521066088717*^9, 
   3.5765210742395573`*^9}, {3.576522421426404*^9, 3.5765224224822397`*^9}, {
   3.576522514348558*^9, 3.576522517005731*^9}, 3.5765370736014977`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["p", "silent"], "[", 
   RowBox[{"i_", ",", " ", "k_"}], "]"}], " ", ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "#", "]"}], " ", ">", " ", "0"}], ",", " ", 
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{"#", ",", " ", 
         RowBox[{"Max", "[", "#", "]"}]}], "]"}], "\[LeftDoubleBracket]", 
       RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", " ", 
      RowBox[{"-", "Infinity"}]}], "]"}], " ", "&"}], "@", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"j", " ", "\[Function]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Log", "[", 
            RowBox[{"trans", "\[LeftDoubleBracket]", 
             RowBox[{"j", ",", " ", "k"}], "\[RightDoubleBracket]"}], "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{"Indeterminate", " ", "\[Rule]", " ", 
             RowBox[{"-", "Infinity"}]}], "}"}]}], ")"}], " ", "+", " ", 
         RowBox[{"viterbi", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", " ", "j"}], "\[RightDoubleBracket]"}]}], ")"}]}], 
      ")"}], " ", "/@", " ", 
     RowBox[{"Select", "[", 
      RowBox[{"statesnum", ",", " ", 
       RowBox[{
        RowBox[{"#", " ", "\[NotEqual]", " ", "k"}], "&"}]}], "]"}]}], 
    ")"}]}]}]], "Input",
 CellChangeTimes->{{3.576519383490182*^9, 3.576519401552936*^9}, 
   3.5765198441477823`*^9, {3.576520343867545*^9, 3.576520344310548*^9}, {
   3.5765207210851927`*^9, 3.576520840267952*^9}, {3.576520870413151*^9, 
   3.5765208889756536`*^9}, {3.57652241767453*^9, 3.576522443857196*^9}, {
   3.576522510381041*^9, 3.5765225114604483`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.576519976676099*^9, 3.5765199941854067`*^9}, {
   3.5765200292759123`*^9, 3.576520051010539*^9}, {3.576520107397591*^9, 
   3.576520121477138*^9}, 3.5765203418992357`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Max", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"-", "Infinity"}], ",", " ", "2", ",", " ", "3"}], "}"}], "]"}]], \
"Input",
 CellChangeTimes->{{3.576520340717494*^9, 3.57652034073917*^9}, {
  3.576521126286768*^9, 3.576521134684554*^9}}],

Cell[BoxData["3"], "Output",
 CellChangeTimes->{{3.576521135121916*^9, 3.5765211740024233`*^9}, 
   3.5765212040336323`*^9, 3.5765212621779203`*^9, 3.576521311880199*^9, 
   3.576521384763522*^9, 3.5765223665736923`*^9, 3.576522400178035*^9, {
   3.576522450342765*^9, 3.576522484265726*^9}, 3.576522520508813*^9, 
   3.576537077401309*^9, 3.57653820199582*^9, 3.576538250139695*^9, 
   3.576538295530776*^9, 3.5765383696369143`*^9, 3.576587380182867*^9, 
   3.576634972548936*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"k", " ", "\[Function]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "letters", "\[LeftDoubleBracket]", "k", 
              "\[RightDoubleBracket]"}], " ", "\[NotEqual]", " ", 
             "\"\<.\>\""}], ",", " ", "\[IndentingNewLine]", "\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{"viterbi", "\[LeftDoubleBracket]", 
               RowBox[{"i", ",", " ", "k"}], "\[RightDoubleBracket]"}], " ", 
              "=", " ", 
              RowBox[{
               SubscriptBox["v", "emitting"], "[", 
               RowBox[{"i", ",", " ", "k"}], "]"}]}], ";"}], ",", " ", 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{
             RowBox[{"viterbi", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", " ", "k"}], "\[RightDoubleBracket]"}], " ", 
             "=", " ", 
             RowBox[{
              SubscriptBox["v", "silent"], "[", 
              RowBox[{"i", ",", " ", "k"}], "]"}]}]}], "]"}], ";"}], " ", 
         ")"}]}], ")"}], " ", "/@", " ", "statesnum"}], ",", " ", 
     "\[IndentingNewLine]", "\t\t\t", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "2", ",", " ", 
       RowBox[{
        RowBox[{"Length", "[", "seq", "]"}], " ", "+", " ", "1"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"viterbi", "//", "TableForm"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.576519480627285*^9, 3.576519536295744*^9}, {
   3.576519705864501*^9, 3.5765197349607887`*^9}, {3.5765202199529877`*^9, 
   3.576520232823052*^9}, 3.5765202647967157`*^9, {3.576538238831965*^9, 
   3.5765382391521597`*^9}, {3.576587334119289*^9, 3.576587339322977*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {"0", 
     RowBox[{"-", "\[Infinity]"}], 
     RowBox[{"-", "\[Infinity]"}], 
     RowBox[{"-", "\[Infinity]"}], 
     RowBox[{"-", "\[Infinity]"}], 
     RowBox[{"-", "\[Infinity]"}], 
     RowBox[{"-", "\[Infinity]"}], 
     RowBox[{"-", "\[Infinity]"}], 
     RowBox[{"-", "\[Infinity]"}], 
     RowBox[{"-", "\[Infinity]"}]},
    {
     RowBox[{"-", "\[Infinity]"}], 
     RowBox[{"-", "2.6239025456517253`"}], 
     RowBox[{"-", "\[Infinity]"}], 
     RowBox[{"-", "\[Infinity]"}], 
     RowBox[{"-", "\[Infinity]"}], 
     RowBox[{"-", "2.0234015307971633`"}], 
     RowBox[{"-", "\[Infinity]"}], 
     RowBox[{"-", "\[Infinity]"}], 
     RowBox[{"-", "\[Infinity]"}], 
     RowBox[{"-", "8.9311568097793`"}]},
    {
     RowBox[{"-", "\[Infinity]"}], 
     RowBox[{"-", "4.359903613934031`"}], 
     RowBox[{"-", "\[Infinity]"}], 
     RowBox[{"-", "\[Infinity]"}], 
     RowBox[{"-", "\[Infinity]"}], 
     RowBox[{"-", "3.2293746677884867`"}], 
     RowBox[{"-", "\[Infinity]"}], 
     RowBox[{"-", "\[Infinity]"}], 
     RowBox[{"-", "\[Infinity]"}], 
     RowBox[{"-", "10.137129946770624`"}]},
    {
     RowBox[{"-", "\[Infinity]"}], 
     RowBox[{"-", "\[Infinity]"}], 
     RowBox[{"-", "\[Infinity]"}], 
     RowBox[{"-", "\[Infinity]"}], 
     RowBox[{"-", "6.50136950659426`"}], 
     RowBox[{"-", "\[Infinity]"}], 
     RowBox[{"-", "\[Infinity]"}], 
     RowBox[{"-", "\[Infinity]"}], 
     RowBox[{"-", "4.7920225101465865`"}], 
     RowBox[{"-", "11.699777789128724`"}]},
    {
     RowBox[{"-", "\[Infinity]"}], 
     RowBox[{"-", "\[Infinity]"}], 
     RowBox[{"-", "\[Infinity]"}], 
     RowBox[{"-", "7.479684589448809`"}], 
     RowBox[{"-", "\[Infinity]"}], 
     RowBox[{"-", "\[Infinity]"}], 
     RowBox[{"-", "\[Infinity]"}], 
     RowBox[{"-", "6.004687986510184`"}], 
     RowBox[{"-", "\[Infinity]"}], 
     RowBox[{"-", "12.912443265492321`"}]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.576587339551099*^9, 3.576587380219903*^9, 
  3.576634972603786*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"k", " ", "\[Function]", 
       RowBox[{"(", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
           "letters", "\[LeftDoubleBracket]", "k", "\[RightDoubleBracket]"}], 
           " ", "\[NotEqual]", " ", "\"\<.\>\""}], ",", " ", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"tracebacks", "\[LeftDoubleBracket]", 
            RowBox[{"i", ",", " ", "k"}], "\[RightDoubleBracket]"}], " ", "=",
            " ", 
           RowBox[{
            SubscriptBox["p", "emitting"], "[", 
            RowBox[{"i", ",", " ", "k"}], "]"}]}], ",", " ", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"tracebacks", "\[LeftDoubleBracket]", 
            RowBox[{"i", ",", " ", "k"}], "\[RightDoubleBracket]"}], " ", "=",
            " ", 
           RowBox[{
            SubscriptBox["p", "silent"], "[", 
            RowBox[{"i", ",", " ", "k"}], "]"}]}]}], " ", "]"}], ")"}]}], 
      ")"}], " ", "/@", " ", "statesnum"}], ",", " ", "\[IndentingNewLine]", 
    "\t\t\t", 
    RowBox[{"{", 
     RowBox[{"i", ",", " ", "2", ",", " ", 
      RowBox[{
       RowBox[{"Length", "[", "seq", "]"}], " ", "+", " ", "1"}]}], "}"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"tracebacks", "//", "TableForm"}]}], "Input",
 CellChangeTimes->{{3.576520277909485*^9, 3.576520316066724*^9}, {
   3.576520457650711*^9, 3.576520484313364*^9}, {3.576520516684273*^9, 
   3.576520572410098*^9}, {3.576520632008527*^9, 3.57652066580744*^9}, {
   3.5765207627511673`*^9, 3.5765207643109283`*^9}, {3.576522476209437*^9, 
   3.576522481103593*^9}, {3.576538243192376*^9, 3.5765382434641457`*^9}, 
   3.576538284634079*^9, {3.5765885870761127`*^9, 3.5765885900125027`*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"-", "\[Infinity]"}], 
     RowBox[{"-", "\[Infinity]"}], 
     RowBox[{"-", "\[Infinity]"}], 
     RowBox[{"-", "\[Infinity]"}], 
     RowBox[{"-", "\[Infinity]"}], 
     RowBox[{"-", "\[Infinity]"}], 
     RowBox[{"-", "\[Infinity]"}], 
     RowBox[{"-", "\[Infinity]"}], 
     RowBox[{"-", "\[Infinity]"}], 
     RowBox[{"-", "\[Infinity]"}]},
    {"1", "1", "1", "1", "1", "1", "1", "1", "1", "6"},
    {"1", "2", "2", "2", "2", "6", "6", "6", "6", "6"},
    {"1", "2", "2", "2", "2", "6", "6", "6", "6", "9"},
    {"1", "5", "5", "5", "5", "9", "9", "9", "9", "8"}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.576588590241373*^9, 3.576634972652569*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"l", " ", "=", " ", 
    RowBox[{
     RowBox[{"Position", "[", 
      RowBox[{
       RowBox[{"Last", " ", "@", " ", "viterbi"}], ",", " ", 
       RowBox[{"Max", " ", "@", " ", 
        RowBox[{"(", 
         RowBox[{"Last", " ", "@", " ", "viterbi"}], ")"}]}]}], "]"}], 
     "\[LeftDoubleBracket]", 
     RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], 
   "\[IndentingNewLine]", " ", 
   RowBox[{
    RowBox[{"Reap", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Sow", "[", 
         RowBox[{
         "symbols", "\[LeftDoubleBracket]", "l", "\[RightDoubleBracket]"}], 
         "]"}], " ", ";", " ", 
        RowBox[{"l", " ", "=", " ", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"Last", " ", "@", " ", "viterbi"}], ",", " ", 
            RowBox[{"Max", " ", "@", " ", 
             RowBox[{"(", 
              RowBox[{"Last", " ", "@", " ", "viterbi"}], ")"}]}]}], "]"}], 
          "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";"}], ",", 
       " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", 
         RowBox[{"Length", "[", "seq", "]"}], ",", " ", "2", ",", " ", 
         RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}], "\[LeftDoubleBracket]", 
    
    RowBox[{"2", ",", " ", "1"}], "\[RightDoubleBracket]"}]}]}]], "Input",
 CellChangeTimes->{{3.576537716817457*^9, 3.576538121012328*^9}, {
  3.576538159115498*^9, 3.576538187169044*^9}, {3.576538246770015*^9, 
  3.5765382470243*^9}, {3.576538291877284*^9, 3.576538292274227*^9}}],

Cell[BoxData["8"], "Output",
 CellChangeTimes->{
  3.5765378592760487`*^9, {3.576537890377305*^9, 3.576537940483766*^9}, 
   3.576538026345305*^9, {3.576538058074274*^9, 3.5765380957146053`*^9}, {
   3.576538165354611*^9, 3.576538202147572*^9}, 3.576538268853565*^9, 
   3.5765383142049227`*^9, 3.5765383697403393`*^9, 3.5765873802822313`*^9, 
   3.576634972682074*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"-\"\>", ",", "\<\"-\"\>", ",", "\<\"-\"\>"}], "}"}]], "Output",\

 CellChangeTimes->{
  3.5765378592760487`*^9, {3.576537890377305*^9, 3.576537940483766*^9}, 
   3.576538026345305*^9, {3.576538058074274*^9, 3.5765380957146053`*^9}, {
   3.576538165354611*^9, 3.576538202147572*^9}, 3.576538268853565*^9, 
   3.5765383142049227`*^9, 3.5765383697403393`*^9, 3.5765873802822313`*^9, 
   3.576634972685875*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.576537387077066*^9, 3.576537406539174*^9}, {
   3.576537480193021*^9, 3.576537556342381*^9}, {3.576537638037498*^9, 
   3.57653763921954*^9}, 3.576537761306501*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.576519000925613*^9, 3.57651906756572*^9}, {
  3.5765191079618063`*^9, 3.5765191082570887`*^9}}]
},
WindowSize->{1440, 804},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"9.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (November 20, \
2012)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[400, 13, 9154, 191, 338, "Input"],
Cell[CellGroupData[{
Cell[9579, 208, 4333, 59, 63, "Input"],
Cell[13915, 269, 3185, 52, 194, "Output"],
Cell[17103, 323, 3506, 62, 194, "Output"],
Cell[20612, 387, 2410, 47, 108, "Output"]
}, Open  ]],
Cell[23037, 437, 6630, 109, 116, "Input"],
Cell[29670, 548, 6432, 102, 131, "Input"],
Cell[CellGroupData[{
Cell[36127, 654, 4377, 61, 28, "Input"],
Cell[40507, 717, 433, 7, 28, "Output"]
}, Open  ]],
Cell[40955, 727, 2239, 49, 82, "Input"],
Cell[43197, 778, 1770, 43, 46, "Input"],
Cell[44970, 823, 220, 3, 28, "Input"],
Cell[CellGroupData[{
Cell[45215, 830, 266, 7, 28, InheritFromParent],
Cell[45484, 839, 481, 7, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46002, 851, 1892, 44, 148, "Input"],
Cell[47897, 897, 2478, 70, 166, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[50412, 972, 1868, 43, 114, "Input"],
Cell[52283, 1017, 1156, 30, 108, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[53476, 1052, 1682, 42, 80, "Input"],
Cell[55161, 1096, 369, 6, 28, "Output"],
Cell[55533, 1104, 450, 9, 28, "Output"]
}, Open  ]],
Cell[55998, 1116, 213, 3, 28, "Input"],
Cell[56214, 1121, 144, 2, 28, "Input"]
}
]
*)

